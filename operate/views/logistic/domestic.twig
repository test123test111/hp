{% set menu_name = "logistic" %}
{% set sidebar_name = "国内物流" %}
{% extends '@view/layouts/main.twig' %}
{% block content %}
<link rel="stylesheet" href="/ace/css/bootstrap-datetimepicker.min.css">
<div class="breadcrumbs breadcrumbs-fixed" id="breadcrumbs">
            <script type="text/javascript">
              try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
            </script>
            <!-- 面包屑 开始 -->
            <ul class="breadcrumb">
              <li>
                <i class="icon-home home-icon"></i>
                <a href="/">主页</a>
              </li>
              <li class="active">国内物流</li>
            </ul><!-- 面包屑 结束 -->
          </div><!-- 主体topbar 开始 -->
          <!-- page-content 开始 -->
<div class="page-content">
  <!-- row 开始 -->
  <div class="row">
    <!-- col 开始 -->
    <div class="col-xs-12">
      <!-- page主要content 开始 -->
      <div class="search-area col-sm-12">
        <!-- 搜索条件 开始 -->
        <div class="search-box">
          <div class="space-10"></div>
          <!-- 分类搜索 开始 -->
          <div class="classified-search">
            <div class="input-group">
              <input id="searchContent" type="text" class="search-bar form-control search-query input-sm" placeholder="请输入想要搜索的ID" />
              <div class="classify-info btn-group">
                <form id="searchBarForm" action="" method="get">
                  <input id="searchType" type="hidden" name="" value="">
                  <button type="button" id="classifiedBtn" data-toggle="dropdown" class="classified-btn btn btn-xs btn-primary dropdown-toggle">
                    <em>快递单号</em>
                    <span class="icon-caret-down icon-on-right"></span>
                  </button>

                  <ul id="searchMenu" class="dropdown-menu dropdown-default">
                    <li><a href="#">订单号</a></li>
                    <li><a href="#">快递单号</a></li>
                  </ul>
                </div>
                <span class="search-btn input-group-btn">
                  <button id="searchBtn" type="button" class="btn btn-primary btn-xs">
                    搜索
                    <i class="icon-search icon-on-right bigger-110"></i>
                  </button>
                </span>
              </form>
            </div>
            <span class="info">可搜索订单/快递单号</span>
          </div>
          <!-- 分类搜索 结束 -->
          <!-- 时间搜索 开始 -->
          <div class="time-search">
            <div class="space-10"></div>
            <div class="update-time inline-block">
              <form id="timeSearchForm" action="" method="get">

                <div class="from">
                  <strong>发件时间</strong>
                  <div class="input-append date form_datetime inline-block">
                      <input id="beginT" name="begin_time" size="16" type="text" value="{% if params.begin_time is defined %}{{ params.begin_time }}{% endif %}" readonly><span class="add-on"><i class="icon-th"></i></span>
                  </div>
                </div>
                <div class="to">
                  <strong>to</strong>
                  <div class="input-append date form_datetime inline-block  ">
                      <input id="endT" name="end_time" size="16" type="text" value="{% if params.end_time is defined %}{{ params.end_time }}{% endif %}" readonly><span class="add-on"><i class="icon-th"></i></span>
                  </div>
                </div>
                <button type="submit" class="btn btn-xs btn-primary">筛选</button>
              </form>
            </div>
          </div>
          <!-- 时间搜索 结束 -->
          <!-- 搜索结果 开始 -->
          <div class="search-results">
            <div class="space-10"></div>
            <div class="results-tab tabbable">
              <ul class="nav nav-tabs" id="tabLevelOne">
                <li class="active">
                  <a data-toggle="tab">全部包裹</a>
                </li>
              </ul>

              <ul id="expressType" class="second-level-tabs nav nav-tabs" id="tabLevelTwo">
                <li {% if params.logistic_provider is not defined %}class="active"{% endif %}>
                  <a href="#" data-toggle="tab">全部</a>
                </li>
                <li {% if params.logistic_provider is defined and params.logistic_provider == "圆通" %}class="active"{% endif %}>
                  <a href="#" data-toggle="tab">圆通</a>
                </li>
                <li {% if params.logistic_provider is defined and params.logistic_provider == "顺丰" %}class="active"{% endif %}>
                  <a href="#" data-toggle="tab">顺丰</a>
                </li>
              </ul>

              <div class="tab-content">
                <div id="home" class="tab-pane in active">
                  <!-- table responsive -->
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <tbody>
                        {% for data in results %}
                        <tr class="info">
                          <td class="order-num" colspan="3">
                                    <span>订单:
                                      {% for order in data.orderInfo %} 
                                      <a href="#">{{ order.order_id }}</a>
                                      {% if loop.last == false %}
                                      /
                                      {% endif %}
                                      {% endfor %}
                                    </span>
                                </td>
                                <td class="time" colspan="4">
                                    <span class="sender">发件人: {% if data.orderInfo.0.orderSend is defined %}{{
                                      data.orderInfo.0.orderSend.managers.username
                                    }}{% else %}{% endif %}</span>
                                    <p class="">发件时间: <time>{{ data.orderInfo.0.create_time|date('Y-m-d H:i:s') }}</time></p>
                                </td>
                        </tr>
                        <tr class="logistics-info-detail">
                          <td class="center">{{ data.orderInfo.0.logistic_provider}}</td>
                          <td class="center">{{ data.orderInfo.0.logistic_no }}</td>
                          {% if data.orderInfo.0.tracking is defined %}
                          <td class="center">{{ data.orderInfo.0.tracking.0.context }}</td>
                          {% else %}
                          <td class="center">暂无物流信息</td>
                          {% endif %}
                          <td class="center">{{ data.orderInfo.0.orders.province }}，{{ data.orderInfo.0.orders.city }}，{{ data.orderInfo.0.orders.addr }}</td>
                          <td class="center">{{ data.orderInfo.0.orders.name }}</td>
                          <td class="center">{{ data.orderInfo.0.orders.cellphone }}</td>
                          <td class="center">详情</td>
                        </tr>
                        <tr class="placeholder">
                                  <td colspan="7"></td>
                        </tr> 
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                  <!-- table responsive -->
                  <!-- Pagination 开始 -->
                  <div class="pages">
                    <button type="button" id="printExpressBtn" class="print-express btn btn-xs btn-primary">打印快递清单</button>

                    <p class="search-sum">共{{ count }}个结果</p>
                    
                    <ul class="pagination">
                        {{ widget('\\yii\\widgets\\LinkPager',{'pagination':pages}) }}
                    </ul>
                    
                  </div>
                  <!-- pagination 结束 -->
                </div>
              </div>
            </div>
          
          </div>
        </div>
      <!-- page主要content 结束 -->
    </div><!-- col 结束 -->
  </div><!-- row 结束 -->
</div><!-- page-content 结束 -->
{% block page_scripts %}
<script type="text/javascript" src="/ace/js/domestic-logistics.js"></script>
<script type="text/javascript" src="/ace/js/bootstrap-datetimepicker.min.js"></script>
<script>
  $(function() {
    $(".form_datetime").datetimepicker({
        format: "yyyy-mm-dd hh:ii"
    });
  })
</script>
{% endblock %}
{% endblock %}
